#pragma once

#include "BBmacros.h"
#include "Position.h"

const PScore materialValues[5] = {
    S(84,169), S(375,548), S(373,570), S(461,958), S(1107,1142)
};

const PScore pawnTable[64] = {
    S(0,0)     , S(0,0)     , S(0,0)     , S(0,0)     , S(0,0)     , S(0,0)     , S(0,0)     , S(0,0)     ,
    S(107,143) , S(71,144)  , S(105,100) , S(119,44)  , S(101,46)  , S(65,73)   , S(-100,157), S(-68,160) ,
    S(11,140)  , S(40,124)  , S(58,83)   , S(52,35)   , S(65,34)   , S(104,66)  , S(61,100)  , S(13,114)  ,
    S(10,88)   , S(12,75)   , S(17,55)   , S(31,26)   , S(40,34)   , S(38,46)   , S(3,74)    , S(2,73)    ,
    S(4,59)    , S(-2,54)   , S(12,35)   , S(21,26)   , S(23,27)   , S(21,37)   , S(2,45)    , S(0,46)    ,
    S(6,48)    , S(4,42)    , S(8,42)    , S(16,37)   , S(25,45)   , S(11,48)   , S(15,34)   , S(9,33)    ,
    S(3,57)    , S(2,50)    , S(1,57)    , S(3,57)    , S(0,66)    , S(22,65)   , S(25,45)   , S(1,32)    ,
    S(0,0)     , S(0,0)     , S(0,0)     , S(0,0)     , S(0,0)     , S(0,0)     , S(0,0)     , S(0,0)     
};

const PScore knightTable[64] = {
    S(-128,24), S(-48,109), S(-65,157), S(47,128) , S(89,121) , S(-55,158), S(-63,123), S(-87,3)  ,
    S(79,77)  , S(74,110) , S(125,111), S(159,141), S(142,144), S(163,100), S(60,111) , S(90,79)  ,
    S(62,98)  , S(96,121) , S(111,161), S(114,165), S(143,156), S(127,163), S(95,130) , S(71,108) ,
    S(94,116) , S(99,133) , S(111,164), S(116,182), S(106,194), S(123,167), S(91,165) , S(100,134),
    S(83,121) , S(92,133) , S(89,159) , S(90,170) , S(102,174), S(95,163) , S(110,137), S(87,132) ,
    S(54,77)  , S(67,108) , S(67,131) , S(76,155) , S(77,153) , S(65,125) , S(66,112) , S(57,85)  ,
    S(37,106) , S(35,112) , S(49,99)  , S(62,120) , S(58,121) , S(50,96)  , S(37,105) , S(45,107) ,
    S(16,67)  , S(51,67)  , S(44,86)  , S(43,109) , S(46,110) , S(45,97)  , S(43,80)  , S(14,57)  
};

const PScore bishopTable[64] = {
    S(34,176) , S(10,175) , S(-37,177), S(-45,184), S(-28,177), S(-61,175), S(41,161) , S(18,174) ,
    S(31,167) , S(90,165) , S(88,159) , S(60,161) , S(80,157) , S(80,160) , S(57,171) , S(47,162) ,
    S(89,164) , S(99,166) , S(118,161), S(97,157) , S(112,154), S(109,173), S(102,165), S(81,172) ,
    S(80,161) , S(114,158), S(96,160) , S(119,174), S(124,174), S(114,158), S(116,161), S(73,168) ,
    S(88,142) , S(89,151) , S(88,171) , S(108,168), S(116,169), S(86,163) , S(94,148) , S(90,137) ,
    S(89,140) , S(101,148), S(93,159) , S(96,161) , S(90,160) , S(92,155) , S(95,140) , S(95,143) ,
    S(100,134), S(99,122) , S(94,137) , S(74,151) , S(74,153) , S(87,135) , S(103,129), S(92,113) ,
    S(107,128), S(90,143) , S(74,145) , S(65,140) , S(61,146) , S(71,150) , S(82,143) , S(97,125) 
};

const PScore rookTable[64] = {
    S(171,331), S(161,339), S(134,351), S(143,343), S(142,345), S(168,342), S(182,336), S(189,330),
    S(142,329), S(127,341), S(153,336), S(166,336), S(154,340), S(178,320), S(142,332), S(156,324),
    S(134,319), S(188,300), S(165,316), S(199,295), S(212,290), S(198,307), S(223,288), S(164,309),
    S(133,307), S(156,304), S(165,306), S(191,294), S(178,299), S(179,300), S(178,300), S(160,300),
    S(108,287), S(115,304), S(114,305), S(126,297), S(118,298), S(118,304), S(139,299), S(122,284),
    S(102,264), S(120,280), S(112,279), S(123,272), S(120,273), S(119,278), S(150,269), S(120,252),
    S(76,264) , S(118,256), S(119,266), S(127,260), S(126,259), S(137,251), S(144,244), S(81,258) ,
    S(122,260), S(126,268), S(130,270), S(140,260), S(136,259), S(141,273), S(143,259), S(131,241)
};

const PScore queenTable[64] = {
    S(116,189), S(141,188), S(113,239), S(117,250), S(96,283) , S(117,274), S(122,229), S(116,218),
    S(136,171), S(77,223) , S(127,210), S(60,281) , S(48,326) , S(118,280), S(52,273) , S(139,197),
    S(141,177), S(143,177), S(128,212), S(129,228), S(133,253), S(132,276), S(135,245), S(129,264),
    S(154,162), S(154,206), S(140,200), S(123,259), S(123,275), S(151,259), S(166,249), S(165,218),
    S(156,125), S(154,171), S(143,184), S(140,230), S(143,221), S(151,208), S(165,175), S(166,165),
    S(158,104), S(169,125), S(160,160), S(157,155), S(159,148), S(162,162), S(177,127), S(174,100),
    S(161,91) , S(170,90) , S(179,77) , S(174,112), S(175,104), S(192,46) , S(186,50) , S(162,83) ,
    S(164,78) , S(173,72) , S(177,73) , S(184,102), S(182,72) , S(174,51) , S(183,48) , S(168,53) 
};

const PScore kingTable[64] = {
    S(-24,-201), S(24,-65)  , S(58,-49)  , S(78,-23)  , S(80,-44)  , S(59,-32)  , S(50,-30)  , S(-19,-196),
    S(-67,-28) , S(69,53)   , S(119,32)  , S(167,0)   , S(137,9)   , S(151,28)  , S(79,62)   , S(-5,-31)  ,
    S(-8,20)   , S(157,54)  , S(180,47)  , S(149,38)  , S(159,33)  , S(225,42)  , S(164,55)  , S(36,2)    ,
    S(-44,18)  , S(108,37)  , S(131,54)  , S(102,56)  , S(117,50)  , S(138,47)  , S(102,36)  , S(-53,4)   ,
    S(-56,-19) , S(59,18)   , S(107,37)  , S(59,61)   , S(77,51)   , S(85,31)   , S(66,9)    , S(-65,-23) ,
    S(-78,-5)  , S(-6,11)   , S(25,25)   , S(4,49)    , S(22,40)   , S(23,19)   , S(1,0)     , S(-54,-20) ,
    S(-10,-19) , S(-26,7)   , S(-36,24)  , S(-90,37)  , S(-72,31)  , S(-60,29)  , S(-15,-4)  , S(-9,-42)  ,
    S(-27,-98) , S(-9,-39)  , S(-49,0)   , S(-114,-9) , S(-74,-34) , S(-104,4)  , S(-12,-39) , S(-4,-129) 
};

const PScore knightMob[9] = {
    S(-26,-114), S(-7,-39), S(6,6), S(12,32), S(17,43), S(22,56), S(30,55), S(39,49), S(49,26)
};

const PScore bishopMob[14] = {
    S(-43,-181), S(-11,-104), S(7,-49), S(14,-21), S(24,0), S(29,19), S(33,31), S(31,39), S(31,49), S(35,50), S(44,44), S(67,28), S(76,32), S(97,-9)
};

const PScore rookMob[15] = {
    S(-16,-154), S(-21,-92), S(-11,-60), S(-11,-42), S(-10,-24), S(-12,-4), S(-9,4), S(-4,5), S(0,10), S(8,15), S(7,21), S(12,26), S(15,29), S(33,8), S(93,-24)
};

const PScore queenMob[28] = {
    S(-128,-433), S(-88,-460), S(-49,-362), S(-29,-272), S(-25,-176), S(-20,-121), S(-16,-87), S(-12,-70), S(-8,-51), S(-4,-39), S(0,-33), S(5,-29), S(9,-27), S(12,-25), S(14,-24), S(15,-23), S(13,-23), S(7,-19), S(10,-24), S(12,-31), S(24,-54), S(29,-69), S(27,-79), S(38,-100), S(23,-111), S(26,-131), S(-7,-90), S(-22,-53)
};

extern const PScore* pestoTables[6];

constexpr Score gamephaseInc[12] = { 0, 1, 1, 2, 4, 0, 0, 1, 1, 2, 4, 0 };
extern PScore PSQTs[12][64];
/**
* @brief The initTables function initializes the material - positional tables
* @note This function is called once at the beginning of the program
*/
void initTables();

/**
 * @brief The pestoEval function evaluates the material and positional scores
 * @param pos The position to evaluate
 * @return The material and positional scores
 */
Score pestoEval(Position* pos);

/** 
 * @brief The initTropism function initializes the tropism tables
 * @note This is called at the start of the program 
 */
void initTropism();

/**
 * @brief The convertToFeatures function converts a set of positions to a set of features
 * @param filename The filename of the epd file
 * @param output The output file to write the features to
 */
void convertToFeatures(std::string filename, std::string output);